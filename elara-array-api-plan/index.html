
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elara Hub</title>
    
    <link rel="stylesheet" href="https://elaraproject.github.io/elara-hub/index.css">
    <!--KaTeX-->
    <link rel="stylesheet" href="https://elaraproject.github.io/elara-hub/katex/katex.min.css">

    <!--Open Sans-->
    <link rel="stylesheet" href="https://elaraproject.github.io/elara-hub/open-sans/open-sans.css">
    
</head>
<body>
    <nav>
    	<span class="header active">
    		<a href="https://elaraproject.github.io/elara-hub">Elara Hub</a> :: <a href="https://elaraproject.github.io/elara-hub/elara-hub-index/">Home</a>
    	</span>
    	<a class="header mobile-only" href="https://elaraproject.github.io/elara-hub/menu/">Menu</a>
    	<ul>
    	 
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/6-month-roadmap-1/">6-month roadmap 1</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/all-about-pdes/">All about partial differential equations</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/alt-de-solver/">Alternate differential equation solver</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/black-hole-raytracing/">Black hole raytracing</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-gfx-continuing-work/">Elara GFX continuing work plan</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-hub-creation/">Elara Hub creation plan</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-hub-index/">Elara Hub Index</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/meta/">Elara Hub Meta</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/markdown-guide/">Elara markdown guide</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-math-optimization/">Elara math optimization strategies</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-ml-api/">Elara ML API proposal</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/elara-array-api-plan/">Elara-array API</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/extra/">Extra content</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/focusing-chamber-1/">Focusing chamber theoretical analysis 1</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/geometrized/">Geometrized units</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/h2-co2/">Hydrogen from CO2 production</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/integration-techniques/">Integration techniques</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/menu/">Menu (for mobile)</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/multivar/">Multivariable calculus guide</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/stages/">Project development stages</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/app-plans/">Project Elara app plans</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/library-plans/">Project Elara library plans</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/outreach-plan/">Project Elara Outreach Plan</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/funny/">Project humour and jokes</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/project-philosophy/">Project Philosophy</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/eval-christoffels/">Quickly evaluating the Christoffel symbols</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/relativity-hub/">Relativity Hub</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/future-extensions/">Speculative future extensions</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/standard-notation/">Standardized calculus notation</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/handbook-addthings/">Things to add to Elara Handbook</a></li>
    	 
    	 	<li><a href="https://elaraproject.github.io/elara-hub/visualization-outreach/">Visualization-based outreach</a></li>
    	 
    	</ul>
    </nav>

    <main>
    	<article>
	    
	<h1>Elara-array API</h1>
	<!--eventually add in authors-->
	<p>Design goals:</p>
<ul>
<li>A pure Rust library designed NOT for FFI, but for use from only Rust.</li>
<li>Minimal set of features, leave more complex math/science functions (e.g. convolution, diff eq solvers) for <code>elara-math</code> to implement</li>
<li>FAST - really really really optimized and fast!!!</li>
</ul>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#65737e;">// Macros for convenient array creation up to 3D
</span><span style="color:#65737e;">// However they are not recommended for array data
</span><span>arr![</span><span style="color:#d08770;">1</span><span>, </span><span style="color:#d08770;">2</span><span>, </span><span style="color:#d08770;">3</span><span>, </span><span style="color:#d08770;">4</span><span>];
</span><span>arr![[</span><span style="color:#d08770;">1</span><span>, </span><span style="color:#d08770;">2</span><span>], [</span><span style="color:#d08770;">3</span><span>, </span><span style="color:#d08770;">4</span><span>]];
</span><span>
</span><span style="color:#65737e;">// Explicit array creation
</span><span style="color:#65737e;">// This is the *only* time data is allocated
</span><span>NdArray::new(your_vec);
</span><span>NdArray::arange(</span><span style="color:#d08770;">0</span><span>..</span><span style="color:#d08770;">10</span><span>);
</span><span>
</span><span style="color:#65737e;">// methods
</span><span style="color:#65737e;">// these either operate in-place
</span><span style="color:#65737e;">// or don&#39;t perform any manipulations on the underlying
</span><span style="color:#65737e;">// data (like the transpose function) to prevent 
</span><span style="color:#65737e;">// copying for efficiency
</span><span>arr.</span><span style="color:#96b5b4;">dot</span><span>(&amp;arr2);
</span><span>arr.</span><span style="color:#96b5b4;">matmul</span><span>(&amp;arr2);
</span><span>arr.</span><span style="color:#96b5b4;">product</span><span>();
</span><span>arr.</span><span style="color:#96b5b4;">len</span><span>();
</span><span>
</span><span style="color:#65737e;">// Operations default to in-place ops to prevent additional
</span><span style="color:#65737e;">// copying or moves of data
</span><span>arr + arr2; </span><span style="color:#65737e;">// returns the result in arr
</span><span>arr * arr2;
</span><span>arr / arr2;
</span><span>
</span><span style="color:#65737e;">// Indexing (for both getting and setting data)
</span><span style="color:#65737e;">// these are implemented by two index implementations,
</span><span style="color:#65737e;">// one for views and one for direct indices
</span><span style="color:#b48ead;">impl </span><span>Index&lt;[</span><span style="color:#b48ead;">f64</span><span>; </span><span style="color:#bf616a;">N</span><span>]&gt; </span><span style="color:#b48ead;">for </span><span>NdArray&lt;T, N&gt;;
</span><span>impl Index&lt;NdArrayView&lt;</span><span style="color:#b48ead;">f64</span><span>, N&gt;&gt; for Ndarray&lt;T, N&gt;;
</span><span>
</span><span style="color:#65737e;">// Construct a view
</span><span style="color:#65737e;">// These replace numpy-style slices
</span><span>let yourview&lt;</span><span style="color:#b48ead;">f64</span><span>, N&gt; = NdArrayView::row_view(start, end, step);
</span><span>
</span><span>arr[[1, 3, 5]]; </span><span style="color:#65737e;">// direct indexing
</span><span>arr[yourview]; </span><span style="color:#65737e;">// view indexing
</span><span>
</span><span style="color:#65737e;">// elara-array uses a specialized
</span><span style="color:#65737e;">// binary file format for serializing arrays
</span><span>arr.save(&quot;array.elr&quot;);
</span><span>NdArray::from_file(&quot;array.elr&quot;);
</span><span>
</span><span style="color:#65737e;">// The entire library supports full error handling
</span><span style="color:#65737e;">// and is designed to be robust even on error
</span></code></pre>
<p>API reference:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#65737e;">// utility methods
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">new</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">zeros</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">ones</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">eye</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">random</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">size</span><span>(); </span><span style="color:#65737e;">// number of elements
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">ndim</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">shape</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">flatten</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">reshape</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">mapv</span><span>(); </span><span style="color:#65737e;">// elementwise in-place map
</span><span>
</span><span style="color:#65737e;">// arithmetic methods
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">sin</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">cos</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">tan</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">arcsin</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">arccos</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">arctan</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">sinh</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">cosh</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">tanh</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">exp</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">sqrt</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">cbrt</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">log</span><span>();
</span><span>
</span><span style="color:#65737e;">// statistical methods
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">sum</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">min</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">max</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">mean</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">median</span><span>();
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">stddev</span><span>(); </span><span style="color:#65737e;">// standard deviation
</span><span>
</span><span style="color:#65737e;">// linalg methods
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">dot</span><span>(); </span><span style="color:#65737e;">// 1D only
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">matmul</span><span>(); </span><span style="color:#65737e;">// 2D only
</span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">transpose</span><span>(); </span><span style="color:#65737e;">// 2D only
</span></code></pre>
<p>Error API:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">struct </span><span>ErrorInfo {
</span><span>    </span><span style="color:#bf616a;">source</span><span>: &amp;</span><span style="color:#b48ead;">&#39;static str</span><span>, </span><span style="color:#65737e;">// the function that called the error
</span><span>    </span><span style="color:#bf616a;">file</span><span>: &amp;</span><span style="color:#b48ead;">&#39;static str</span><span>,
</span><span>    </span><span style="color:#bf616a;">line</span><span>: </span><span style="color:#b48ead;">usize</span><span>,
</span><span>    </span><span style="color:#bf616a;">additional_info</span><span>: String
</span><span>}
</span><span>
</span><span style="color:#b48ead;">pub enum </span><span>{
</span><span>    SomeError1(ErrorInfo),
</span><span>    SomeError2(ErrorInfo)
</span><span>}
</span></code></pre>
<p>Slice/View API:</p>
<pre data-lang="rust" style="background-color:#2b303b;color:#c0c5ce;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#b48ead;">pub fn </span><span style="color:#8fa1b3;">slice</span><span>(&amp;</span><span style="color:#bf616a;">self</span><span>, </span><span style="color:#bf616a;">slice</span><span>: &amp;[Range&lt;</span><span style="color:#b48ead;">usize</span><span>&gt;]) -&gt; ArrayView&lt;T, N&gt;;
</span><span style="color:#b48ead;">pub struct </span><span>ArraySlice;
</span><span>
</span><span style="color:#65737e;">// usage
</span><span style="color:#b48ead;">let</span><span> a = arr![[</span><span style="color:#d08770;">0.0</span><span>, </span><span style="color:#d08770;">1.0</span><span>], [</span><span style="color:#d08770;">2.0</span><span>, </span><span style="color:#d08770;">3.0</span><span>]];
</span><span>
</span><span style="color:#65737e;">// returns view of entire array
</span><span>a[&amp;[.., ..]]
</span><span>
</span><span style="color:#65737e;">// returns view of 1st inner element
</span><span>a[&amp;[s!(</span><span style="color:#d08770;">0</span><span>), ..]] </span><span style="color:#65737e;">// this is equal to a[&amp;[..1, ..]]
</span><span>
</span><span style="color:#65737e;">// returns view of range
</span><span>a[&amp;[</span><span style="color:#d08770;">1</span><span>..</span><span style="color:#d08770;">2</span><span>, </span><span style="color:#d08770;">1</span><span>..</span><span style="color:#d08770;">2</span><span>]]
</span><span>
</span><span style="color:#65737e;">// for more exotic slices use the dedicated slicer
</span><span style="color:#b48ead;">let</span><span> s = ArraySlice::new_columns([</span><span style="color:#d08770;">1</span><span>, </span><span style="color:#d08770;">5</span><span>, </span><span style="color:#d08770;">8</span><span>]);
</span><span>a[s] </span><span style="color:#65737e;">// returns another view
</span></code></pre>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
Change all existing copying operations to operate in-place by default</li>
<li><input disabled="" type="checkbox"/>
Implement arrayslices and views
<ul>
<li><input disabled="" type="checkbox"/>
ArraySlices use a numpy-like syntax for indexing</li>
<li><input disabled="" type="checkbox"/>
Views wrap a standard rust slice (<code>&amp;[T]</code>) of an array</li>
</ul>
</li>
<li><input disabled="" type="checkbox"/>
GPU support (this is most important!!!)
<ul>
<li><input disabled="" type="checkbox"/>
Headless OpenGL context with <code>glfw</code> Rust bindings (see <a href="https://crates.io/crates/gl-headless">https://crates.io/crates/gl-headless</a> for reference)</li>
<li><input disabled="" type="checkbox"/>
GPU computation</li>
</ul>
</li>
<li><input disabled="" type="checkbox"/>
API completion</li>
<li><input disabled="" type="checkbox" checked=""/>
For select operations, implement alternative methods that create a new NdArray with the <code>_copy</code> suffix e.g. <code>matmul_copy()</code></li>
<li><input disabled="" type="checkbox"/>
Clean up examples to just 2 - one showing basic usage and indexing, and the other showing an applied example with an ODE solver</li>
<li><input disabled="" type="checkbox"/>
Write tests for library</li>
<li><input disabled="" type="checkbox"/>
Benchmark library to ensure good performance and add elara array benchmarks</li>
<li><input disabled="" type="checkbox"/>
More helpful error messages (for good developer experience)</li>
<li><input disabled="" type="checkbox"/>
Implement binary serialization</li>
</ul>
<p>Optimizations:</p>
<ul>
<li>GPU computation &amp; keeping data on the GPU for as long as possible</li>
<li>Using a clone-on-write backing array (<code>Cow</code>) so that no clones will be done unless necessary</li>
</ul>


	    </article>
    </main>

    <script>
    // Necessary until pulldown-cmark (which Zola depends on)
    // auto-appends a .tasklist class to all list items
    // that contain task lists
    document.querySelectorAll("input[type='checkbox']").forEach((el) => el.parentElement.classList.add("tasklist"));
    </script>

    <script defer src="https://elaraproject.github.io/elara-hub/katex/katex.min.js"></script>
    <script defer src="https://elaraproject.github.io/elara-hub/katex/contrib/auto-render.min.js"></script>

    <script>
    	// Loading KaTeX
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
              // customised options
              // • auto-render specific keys, e.g.:
              delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false},
                  {left: '\\[', right: '\\]', display: true}
              ],
              // • rendering keys, e.g.:
              throwOnError : false
            });
        });
    </script>
</body>
</html>
